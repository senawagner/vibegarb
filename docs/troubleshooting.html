<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Troubleshooting - Vibe Garb E-commerce</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>📚 Documentação</h2>
                <p>Vibe Garb E-commerce</p>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="index.html">🏠 Início</a></li>
                    <li><a href="architecture.html">🏗️ Arquitetura</a></li>
                    <li><a href="database.html">🗄️ Banco de Dados</a></li>
                    <li><a href="development.html">🚀 Desenvolvimento</a></li>
                    <li><a href="build.html">🔨 Sistema de Build</a></li>
                    <li><a href="checkout-implementation.html">💳 Checkout</a></li>
                    <li><a href="current-status.html">📊 Status Atual</a></li>
                    <li><a href="mvp-plan.html">📋 Plano MVP</a></li>
                    <li><a href="mvp-migrations.html">🔧 Migrações MVP</a></li>
                    <li><a href="troubleshooting.html" class="active">🛠️ Troubleshooting</a></li>
                    <li><a href="session-implementations.html">📝 Implementações</a></li>
                    <li><a href="dropshipping-model.html">📦 Modelo Dropshipping</a></li>
                    <li><a href="git-workflow.html">🔄 Git Workflow</a></li>
                    <li><a href="safe-development.html">🛡️ Desenvolvimento Seguro</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <h1>🛠️ Troubleshooting</h1>
                <p class="subtitle">Guia completo de resolução de problemas do Vibe Garb E-commerce. Este documento registra todos os problemas identificados durante o desenvolvimento, suas causas raiz, soluções implementadas e impacto no sistema. Serve como base de conhecimento para diagnóstico e resolução rápida de issues similares.</p>
                <p class="date">Atualizado em: 07/07/2025 - Última revisão completa</p>
            </header>

            <div class="content-grid">
                <!-- Índice de Problemas -->
                <div class="card">
                    <h2>📋 Índice de Problemas Resolvidos</h2>
                    <div class="problem-index">
                        <div class="index-section">
                            <h3>🔴 Problemas Críticos</h3>
                            <ul>
                                <li><a href="#problem-01">Carrinho Vazio no Checkout</a></li>
                                <li><a href="#problem-02">Relacionamento [images] Indefinido</a></li>
                                <li><a href="#problem-03">Array Key "items" Não Encontrada</a></li>
                                <li><a href="#problem-04">Column 'user_id' Cannot be Null</a></li>
                            </ul>
                        </div>
                        <div class="index-section">
                            <h3>🟡 Problemas de Interface</h3>
                            <ul>
                                <li><a href="#problem-05">Route [admin.orders.send_to_production] Not Defined</a></li>
                                <li><a href="#problem-06">Ações dos Botões Não Funcionavam</a></li>
                                <li><a href="#problem-07">View [admin.dropshipping.show] Not Found</a></li>
                            </ul>
                        </div>
                        <div class="index-section">
                            <h3>🟢 Problemas de Configuração</h3>
                            <ul>
                                <li><a href="#problem-08">Erro de Assets não Encontrados</a></li>
                                <li><a href="#problem-09">Session Store não Configurado</a></li>
                                <li><a href="#problem-10">Permission Denied em Storage</a></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Padrão de Documentação -->
                <div class="card">
                    <h2>📝 Padrão de Documentação</h2>
                    <p>Todos os problemas neste documento seguem a estrutura padronizada:</p>
                    <div class="documentation-pattern">
                        <div class="pattern-item">
                            <span class="pattern-icon">🔍</span>
                            <strong>Problema:</strong> Descrição clara do erro ou comportamento inesperado
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-icon">🔎</span>
                            <strong>Causa Raiz:</strong> Análise técnica da origem do problema
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-icon">⚡</span>
                            <strong>Solução Implementada:</strong> Código e alterações aplicadas
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-icon">📊</span>
                            <strong>Impacto:</strong> Resultado da correção no sistema
                        </div>
                    </div>
                </div>

                <!-- Problemas Críticos -->
                <div class="card card-full">
                    <h2>🔴 PROBLEMAS CRÍTICOS RESOLVIDOS</h2>

                    <div class="problem-card" id="problem-01">
                        <h3>❌ → ✅ Carrinho Vazio no Checkout</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p>Ao clicar "Finalizar Compra", sistema redirecionava com erro "carrinho está vazio", mesmo com produtos visíveis no carrinho.</p>
                                <div class="error-trace">
                                    <code>SQLSTATE[23000]: Integrity constraint violation: 1048 Column 'items' cannot be null</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Inconsistência entre chaves de sessão: CheckoutController acessava sessão com chave 'cart', mas CartService persistia dados com chave 'shopping_cart'.</p>
                                <div class="cause-analysis">
                                    <strong>Conflito de Keys:</strong>
                                    <ul>
                                        <li><code>CheckoutController</code>: <code>session()->get('cart', [])</code></li>
                                        <li><code>CartService</code>: <code>session()->put('shopping_cart', $items)</code></li>
                                    </ul>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// app/Http/Controllers/CheckoutController.php
// ANTES:
$cart = session()->get('cart', []);
if (empty($cart)) {
    return redirect()->route('cart.index')
        ->with('error', 'Seu carrinho está vazio.');
}

// DEPOIS:
$cart = $this->cartService->getContents();
if (empty($cart)) {
    return redirect()->route('cart.index')
        ->with('error', 'Seu carrinho está vazio.');
}</code></pre>
                                </div>
                                <p><strong>Refatoração:</strong> Centralizou acesso ao carrinho através do CartService, garantindo consistência.</p>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Checkout agora acessa corretamente dados do carrinho</li>
                                    <li>✅ Eliminação de inconsistências de sessão</li>
                                    <li>✅ Fluxo de compra 100% funcional</li>
                                    <li>✅ Arquitetura mais limpa com responsabilidades centralizadas</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-02">
                        <h3>❌ → ✅ Relacionamento [images] Indefinido</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p>Erro "Call to undefined relationship [images] on model [App\Models\Product]" em múltiplas partes do sistema.</p>
                                <div class="error-trace">
                                    <code>BadMethodCallException: Call to undefined relationship [images] on model [App\Models\Product]</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Código tentava carregar relacionamento 'images' que não existia. O relacionamento correto era 'productImages' conforme definido no modelo Product.</p>
                                <div class="cause-analysis">
                                    <strong>Relacionamento Correto:</strong>
                                    <code>public function productImages() { return $this->hasMany(ProductImage::class); }</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// app/Services/CartService.php
// ANTES:
Product::with('images')->whereIn('id', $productIds)->get()

// DEPOIS:
Product::with('productImages')->whereIn('id', $productIds)->get()

// app/Http/Controllers/Admin/DropshippingController.php
// ANTES:
$order->load(['user', 'items.product.images'])

// DEPOIS:
$order->load(['user', 'items.product.productImages'])

// app/Models/ProductImage.php - ADICIONADO accessor para compatibilidade:
public function getImageUrlAttribute(): string
{
    return $this->image_path;
}</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Relacionamentos de imagens funcionam em todo sistema</li>
                                    <li>✅ Eliminação de erros de relacionamento indefinido</li>
                                    <li>✅ Compatibilidade mantida com accessor image_url</li>
                                    <li>✅ Carregamento otimizado de imagens nos produtos</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-03">
                        <h3>❌ → ✅ Array Key "items" Não Encontrada</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p>View checkout tentava acessar $cartSummary['items'] que não existia, causando erro de chave não encontrada.</p>
                                <div class="error-trace">
                                    <code>Undefined array key "items" in resources/views/checkout/index.blade.php</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Inconsistência entre estrutura de dados retornada pelo CartService e esperada pela view. Controller passava $cartItems separadamente, mas view esperava dentro de $cartSummary.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// resources/views/checkout/index.blade.php
// ANTES:
@foreach($cartSummary['items'] as $item)
    <!-- ... -->
@endforeach
{{ $cartSummary['formatted_shipping_cost'] }}
{{ $cartSummary['formatted_pix_discount'] }}

// DEPOIS:
@foreach($cartItems as $item)
    <!-- ... -->
@endforeach
{{ $cartSummary['formatted_shipping'] }}
{{ number_format($cartSummary['pix_discount'], 2, ',', '.') }}</code></pre>
                                </div>
                                <p><strong>Ajuste:</strong> Adequou view às variáveis realmente disponíveis e formatação correta.</p>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Página checkout exibe corretamente resumo do pedido</li>
                                    <li>✅ Eliminação de erros de chaves indefinidas</li>
                                    <li>✅ Formatação monetária consistente</li>
                                    <li>✅ Interface de checkout completamente funcional</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-04">
                        <h3>❌ → ✅ Column 'user_id' Cannot be Null</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p>Erro ao finalizar compra sem login - sistema não permitia checkout para usuários anônimos.</p>
                                <div class="error-trace">
                                    <code>SQLSTATE[23000]: Integrity constraint violation: 1048 Column 'user_id' cannot be null</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Campo user_id na tabela orders não permitia NULL, mas o sistema precisava suportar pedidos de usuários não logados (checkout anônimo).</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// Nova migration criada:
// database/migrations/2025_07_07_032019_make_user_id_nullable_in_orders_table.php
public function up()
{
    Schema::table('orders', function (Blueprint $table) {
        $table->dropForeign(['user_id']);
        $table->foreignId('user_id')->nullable()->change();
        $table->foreign('user_id')->references('id')
              ->on('users')->onDelete('set null');
    });
}

// Também corrigido bug no OrderCreationService:
// ANTES:
'total_price' => $item['total'], // Campo inexistente

// DEPOIS:
'total_price' => $item['quantity'] * $item['unit_price'],</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Sistema permite checkout para usuários logados e anônimos</li>
                                    <li>✅ Maior flexibilidade no processo de compra</li>
                                    <li>✅ Constraint de foreign key atualizada adequadamente</li>
                                    <li>✅ Estrutura preparada para diferentes tipos de clientes</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Problemas de Interface -->
                <div class="card card-full">
                    <h2>🟡 PROBLEMAS DE INTERFACE RESOLVIDOS</h2>

                    <div class="problem-card" id="problem-05">
                        <h3>❌ → ✅ Route [admin.orders.send_to_production] Not Defined</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p>View tentava usar rota inexistente, causando erro 404 nos botões de ação do painel administrativo.</p>
                                <div class="error-trace">
                                    <code>Route [admin.orders.send_to_production] not defined</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Nome da rota na view não coincidia com as rotas realmente definidas em web.php. Inconsistência entre nomenclatura esperada e implementada.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// resources/views/admin/orders/index.blade.php
// ANTES:
{{ route('admin.orders.send_to_production', $order) }}

// DEPOIS:
{{ route('admin.dropshipping.update_production_status', $order) }}

// Verificação das rotas em web.php:
Route::post('/admin/dropshipping/{order}/update-production-status', 
    [DropshippingController::class, 'updateProductionStatus'])
    ->name('admin.dropshipping.update_production_status');</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Botão "Enviar para Produção" funciona corretamente</li>
                                    <li>✅ Eliminação de erros 404 nos botões administrativos</li>
                                    <li>✅ Consistência entre rotas e views</li>
                                    <li>✅ Fluxo administrativo completamente funcional</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-06">
                        <h3>❌ → ✅ Ações dos Botões Não Funcionavam</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p>Botões na lista de pedidos não executavam ações - problemas de sintaxe e dados simulados impediam funcionamento.</p>
                                <div class="error-trace">
                                    <code>Trying to get property 'id' of non-object</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Controller retornava arrays simulados, mas view usava sintaxe de objeto. Mistura entre dados mock e estrutura real causava incompatibilidade.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// app/Http/Controllers/AdminController.php
// ANTES: Dados simulados
$orders = [
    ['id' => 1, 'customer_name' => 'Mock Customer', ...],
    // ... mais dados fake
];

// DEPOIS: Dados reais do banco
$orders = Order::with('items.product')
    ->orderBy('created_at', 'desc')
    ->paginate(20);

// resources/views/admin/orders/index.blade.php
// ANTES: Sintaxe de array
{{ $order['id'] }}
{{ $order['customer_name'] }}

// DEPOIS: Sintaxe de objeto
{{ $order->order_number }}
{{ $order->customer_name }}</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Todos botões funcionam: ver detalhes, filtros, ações</li>
                                    <li>✅ Dados reais do banco exibidos corretamente</li>
                                    <li>✅ Interface administrativa totalmente operacional</li>
                                    <li>✅ Eliminação de dados simulados do sistema</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-07">
                        <h3>❌ → ✅ View [admin.dropshipping.show] Not Found</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p>Controller tentava carregar view de detalhes que não existia, causando erro 404 ao tentar visualizar pedidos.</p>
                                <div class="error-trace">
                                    <code>View [admin.dropshipping.show] not found</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Arquivo show.blade.php não existia no diretório admin/dropshipping/. Controller estava configurado mas view correspondente não foi criada.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// Criada view completa em:
// resources/views/admin/dropshipping/show.blade.php

Seções implementadas:
✅ Header com informações do pedido (número, status, valor)
✅ Dados completos do cliente (nome, email, telefone, documento)
✅ Endereço de entrega formatado e completo
✅ Lista detalhada de produtos com variações e preços
✅ Botões de ação funcionais (voltar, imprimir, etc.)
✅ Design consistente com layout administrativo</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Página de detalhes carrega com todas informações</li>
                                    <li>✅ Navegação completa no painel administrativo</li>
                                    <li>✅ Interface profissional para visualização de pedidos</li>
                                    <li>✅ Funcionalidade de dropshipping completamente operacional</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Problemas de Configuração -->
                <div class="card card-full">
                    <h2>🟢 PROBLEMAS DE CONFIGURAÇÃO COMUNS</h2>

                    <div class="problem-card" id="problem-08">
                        <h3>⚠️ → ✅ Erro de Assets não Encontrados</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p>Arquivos CSS e JS retornando 404, interface sem estilos e funcionalidades JavaScript não carregando.</p>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Assets não compilados ou diretório build inexistente após limpeza de cache.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Recompilação de assets
npm run build

# Se persistir, forçar limpeza:
rm -rf public/build
npm run build

# Para desenvolvimento:
npm run dev</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Interface carrega com estilos corretos</li>
                                    <li>✅ JavaScript funcional</li>
                                    <li>✅ Assets otimizados para produção</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-09">
                        <h3>⚠️ → ✅ Session Store não Configurado</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p>Erro de sessão não configurada, dados de carrinho perdidos entre requests.</p>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Configuração de sessão incorreta no .env ou cache de configuração desatualizado.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Verificar .env:
SESSION_DRIVER=file
SESSION_LIFETIME=120

# Limpar cache:
php artisan config:clear
php artisan cache:clear</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Sessões funcionando corretamente</li>
                                    <li>✅ Carrinho persiste entre páginas</li>
                                    <li>✅ Login administrativo estável</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-10">
                        <h3>⚠️ → ✅ Permission Denied em Storage</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p>Erro de permissão ao tentar escrever logs ou cache, sistema instável.</p>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Permissões incorretas nos diretórios storage/ e bootstrap/cache/.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Docker (dentro do container):
chown -R www-data:www-data /var/www/storage
chown -R www-data:www-data /var/www/bootstrap/cache
chmod -R 775 /var/www/storage
chmod -R 775 /var/www/bootstrap/cache

# Local:
chmod -R 775 storage/
chmod -R 775 bootstrap/cache/</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Sistema de logs funcionando</li>
                                    <li>✅ Cache operacional</li>
                                    <li>✅ Estabilidade completa</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Problemas do Sistema de Build -->
                <div class="card card-full">
                    <h2>🔨 PROBLEMAS DO SISTEMA DE BUILD</h2>
                    <p><em>Referência: <a href="build.html">Sistema de Build</a> - Problemas específicos do pipeline de assets e Docker</em></p>

                    <div class="problem-card" id="problem-11">
                        <h3>⚠️ → ✅ Assets Não Carregando no Sistema de Build</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p><strong>Contexto:</strong> Sistema de Build - Pipeline de Assets</p>
                                <p>CSS/JS não aparecem na página após processo de build, interface renderiza sem estilos.</p>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Build anterior corrompido ou manifesto de assets desatualizado. Processo Vite não completou corretamente.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Remover build anterior
rm -rf public/build

# Rebuild assets
docker exec vibegarb_node npm run build

# Verificar se manifest foi gerado
cat public/build/manifest.json</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Assets CSS/JS carregam corretamente</li>
                                    <li>✅ Interface renderiza com estilos Tailwind</li>
                                    <li>✅ Pipeline de build funcional</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-12">
                        <h3>⚠️ → ✅ Erro 504 Gateway Timeout no Build</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p><strong>Contexto:</strong> Sistema de Build - Vite Dev Server</p>
                                <p>Vite dev server não responde, causando timeout na conexão durante desenvolvimento.</p>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Arquivo public/hot ficou órfão após crash do dev server, fazendo Laravel buscar servidor que não existe.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Remover arquivo hot
rm -f public/hot

# Parar dev server e fazer build estático
docker exec vibegarb_node npm run build</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Eliminação de timeouts durante desenvolvimento</li>
                                    <li>✅ Build estático funciona normalmente</li>
                                    <li>✅ Dev server pode ser reiniciado sem problemas</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-13">
                        <h3>⚠️ → ✅ Performance Lenta no Windows (Build)</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p><strong>Contexto:</strong> Sistema de Build - Docker Performance</p>
                                <p>Build muito lento em Windows, operações Docker demoram excessivamente.</p>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Volumes Docker sem otimização :cached, vendor e node_modules sendo sincronizados desnecessariamente entre host e container.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code># docker-compose.yml otimizado:
volumes:
  - ./:/var/www:cached  # :cached é crucial para Windows
  - /var/www/vendor     # Vendor no container
  - /var/www/node_modules # Node modules no container</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Build 3-5x mais rápido no Windows</li>
                                    <li>✅ Operações Docker otimizadas</li>
                                    <li>✅ Developer experience significativamente melhor</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-14">
                        <h3>⚠️ → ✅ Tailwind Não Aplicando Estilos no Build</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p><strong>Contexto:</strong> Sistema de Build - Tailwind CSS Pipeline</p>
                                <p>Classes Tailwind não funcionam, CSS não inclui estilos esperados após build.</p>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Configuração tailwind.config.js com paths incorretos ou processo de purge removendo classes necessárias.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Verificar tailwind.config.js content paths
# Rebuild para forçar purge
docker exec vibegarb_node npm run build

# Verificar se CSS inclui as classes
grep -A 5 "@tailwind" resources/css/app.css</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Classes Tailwind funcionam corretamente</li>
                                    <li>✅ CSS compilado com estilos necessários</li>
                                    <li>✅ Interface responsiva como esperado</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-15">
                        <h3>⚠️ → ✅ Container Node Não Responde</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>🔍 Problema</h4>
                                <p><strong>Contexto:</strong> Sistema de Build - Container Management</p>
                                <p>Comandos npm não executam, container Node inacessível ou travado.</p>
                            </div>

                            <div class="problem-section">
                                <h4>🔎 Causa Raiz</h4>
                                <p>Container Node crashou ou não foi iniciado corretamente, processo principal não está ativo.</p>
                            </div>

                            <div class="problem-section">
                                <h4>⚡ Solução Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Verificar se container está rodando
docker ps | grep vibegarb_node

# Restart container Node
docker-compose restart node

# Verificar logs
docker logs vibegarb_node</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>📊 Impacto</h4>
                                <ul>
                                    <li>✅ Container Node operacional</li>
                                    <li>✅ Comandos npm executam normalmente</li>
                                    <li>✅ Pipeline de build totalmente funcional</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Comandos Úteis -->
                <div class="card">
                    <h2>⚡ Comandos Úteis para Troubleshooting</h2>

                    <h3>Diagnóstico Geral</h3>
                    <div class="code-block">
                        <pre><code># Verificar logs em tempo real
tail -f storage/logs/laravel.log

# Status das migrations
php artisan migrate:status

# Limpar todos os caches
php artisan optimize:clear

# Verificar rotas
php artisan route:list | grep admin</code></pre>
                    </div>

                    <h3>Problemas de Assets</h3>
                    <div class="code-block">
                        <pre><code># Recompilar assets
npm run build

# Forçar limpeza completa
rm -rf public/build node_modules
npm install
npm run build</code></pre>
                    </div>

                    <h3>Problemas de Banco</h3>
                    <div class="code-block">
                        <pre><code># Resetar banco (CUIDADO!)
php artisan migrate:fresh --seed

# Executar migrations pendentes
php artisan migrate

# Verificar conexão
php artisan tinker
> DB::connection()->getPdo();</code></pre>
                    </div>
                </div>

                <!-- Prevenção de Problemas -->
                <div class="card">
                    <h2>🛡️ Prevenção de Problemas</h2>

                    <h3>Checklist Antes de Deploy</h3>
                    <ul>
                        <li>✅ <strong>Assets Compilados:</strong> <code>npm run build</code></li>
                        <li>✅ <strong>Migrations Atualizadas:</strong> <code>php artisan migrate:status</code></li>
                        <li>✅ <strong>Cache Limpo:</strong> <code>php artisan optimize:clear</code></li>
                        <li>✅ <strong>Configuração Verificada:</strong> <code>.env</code> atualizado</li>
                        <li>✅ <strong>Permissões Corretas:</strong> <code>storage/</code> e <code>bootstrap/cache/</code></li>
                        <li>✅ <strong>Logs Verificados:</strong> Sem erros críticos</li>
                    </ul>

                    <h3>Monitoramento Contínuo</h3>
                    <ul>
                        <li>📊 <strong>Performance:</strong> Tempo de carregamento < 1s</li>
                        <li>🔍 <strong>Logs:</strong> Verificação diária de erros</li>
                        <li>💾 <strong>Banco:</strong> Backup regular e integridade</li>
                        <li>🔄 <strong>Sessões:</strong> Funcionamento de carrinho e login</li>
                        <li>🎯 <strong>Funcionalidades:</strong> Teste de checkout completo</li>
                    </ul>
                </div>

                <!-- Contato para Suporte -->
                <div class="card conclusion">
                    <h2>📞 Suporte Técnico</h2>
                    <p>Para problemas não cobertos neste guia:</p>
                    
                    <h3>Procedimento de Reporte</h3>
                    <ol>
                        <li><strong>Capturar Logs:</strong> <code>tail -f storage/logs/laravel.log</code></li>
                        <li><strong>Reproduzir Erro:</strong> Passos detalhados para reprodução</li>
                        <li><strong>Ambiente:</strong> Local/Docker/Produção</li>
                        <li><strong>Contexto:</strong> O que foi feito antes do erro</li>
                    </ol>

                    <p><strong>Base de Conhecimento:</strong> Este documento é atualizado continuamente com novos problemas e soluções.</p>
                </div>
            </div>
        </main>
    </div>
</body>
</html> 