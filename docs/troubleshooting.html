<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Troubleshooting - Vibe Garb E-commerce</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>ğŸ“š DocumentaÃ§Ã£o</h2>
                <p>Vibe Garb E-commerce</p>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="index.html">ğŸ  InÃ­cio</a></li>
                    <li><a href="architecture.html">ğŸ—ï¸ Arquitetura</a></li>
                    <li><a href="database.html">ğŸ—„ï¸ Banco de Dados</a></li>
                    <li><a href="development.html">ğŸš€ Desenvolvimento</a></li>
                    <li><a href="build.html">ğŸ”¨ Sistema de Build</a></li>
                    <li><a href="checkout-implementation.html">ğŸ’³ Checkout</a></li>
                    <li><a href="current-status.html">ğŸ“Š Status Atual</a></li>
                    <li><a href="mvp-plan.html">ğŸ“‹ Plano MVP</a></li>
                    <li><a href="mvp-migrations.html">ğŸ”§ MigraÃ§Ãµes MVP</a></li>
                    <li><a href="troubleshooting.html" class="active">ğŸ› ï¸ Troubleshooting</a></li>
                    <li><a href="session-implementations.html">ğŸ“ ImplementaÃ§Ãµes</a></li>
                    <li><a href="dropshipping-model.html">ğŸ“¦ Modelo Dropshipping</a></li>
                    <li><a href="git-workflow.html">ğŸ”„ Git Workflow</a></li>
                    <li><a href="safe-development.html">ğŸ›¡ï¸ Desenvolvimento Seguro</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <h1>ğŸ› ï¸ Troubleshooting</h1>
                <p class="subtitle">Guia completo de resoluÃ§Ã£o de problemas do Vibe Garb E-commerce. Este documento registra todos os problemas identificados durante o desenvolvimento, suas causas raiz, soluÃ§Ãµes implementadas e impacto no sistema. Serve como base de conhecimento para diagnÃ³stico e resoluÃ§Ã£o rÃ¡pida de issues similares.</p>
                <p class="date">Atualizado em: 07/07/2025 - Ãšltima revisÃ£o completa</p>
            </header>

            <div class="content-grid">
                <!-- Ãndice de Problemas -->
                <div class="card">
                    <h2>ğŸ“‹ Ãndice de Problemas Resolvidos</h2>
                    <div class="problem-index">
                        <div class="index-section">
                            <h3>ğŸ”´ Problemas CrÃ­ticos</h3>
                            <ul>
                                <li><a href="#problem-01">Carrinho Vazio no Checkout</a></li>
                                <li><a href="#problem-02">Relacionamento [images] Indefinido</a></li>
                                <li><a href="#problem-03">Array Key "items" NÃ£o Encontrada</a></li>
                                <li><a href="#problem-04">Column 'user_id' Cannot be Null</a></li>
                            </ul>
                        </div>
                        <div class="index-section">
                            <h3>ğŸŸ¡ Problemas de Interface</h3>
                            <ul>
                                <li><a href="#problem-05">Route [admin.orders.send_to_production] Not Defined</a></li>
                                <li><a href="#problem-06">AÃ§Ãµes dos BotÃµes NÃ£o Funcionavam</a></li>
                                <li><a href="#problem-07">View [admin.dropshipping.show] Not Found</a></li>
                            </ul>
                        </div>
                        <div class="index-section">
                            <h3>ğŸŸ¢ Problemas de ConfiguraÃ§Ã£o</h3>
                            <ul>
                                <li><a href="#problem-08">Erro de Assets nÃ£o Encontrados</a></li>
                                <li><a href="#problem-09">Session Store nÃ£o Configurado</a></li>
                                <li><a href="#problem-10">Permission Denied em Storage</a></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- PadrÃ£o de DocumentaÃ§Ã£o -->
                <div class="card">
                    <h2>ğŸ“ PadrÃ£o de DocumentaÃ§Ã£o</h2>
                    <p>Todos os problemas neste documento seguem a estrutura padronizada:</p>
                    <div class="documentation-pattern">
                        <div class="pattern-item">
                            <span class="pattern-icon">ğŸ”</span>
                            <strong>Problema:</strong> DescriÃ§Ã£o clara do erro ou comportamento inesperado
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-icon">ğŸ”</span>
                            <strong>Causa Raiz:</strong> AnÃ¡lise tÃ©cnica da origem do problema
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-icon">âš¡</span>
                            <strong>SoluÃ§Ã£o Implementada:</strong> CÃ³digo e alteraÃ§Ãµes aplicadas
                        </div>
                        <div class="pattern-item">
                            <span class="pattern-icon">ğŸ“Š</span>
                            <strong>Impacto:</strong> Resultado da correÃ§Ã£o no sistema
                        </div>
                    </div>
                </div>

                <!-- Problemas CrÃ­ticos -->
                <div class="card card-full">
                    <h2>ğŸ”´ PROBLEMAS CRÃTICOS RESOLVIDOS</h2>

                    <div class="problem-card" id="problem-01">
                        <h3>âŒ â†’ âœ… Carrinho Vazio no Checkout</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p>Ao clicar "Finalizar Compra", sistema redirecionava com erro "carrinho estÃ¡ vazio", mesmo com produtos visÃ­veis no carrinho.</p>
                                <div class="error-trace">
                                    <code>SQLSTATE[23000]: Integrity constraint violation: 1048 Column 'items' cannot be null</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>InconsistÃªncia entre chaves de sessÃ£o: CheckoutController acessava sessÃ£o com chave 'cart', mas CartService persistia dados com chave 'shopping_cart'.</p>
                                <div class="cause-analysis">
                                    <strong>Conflito de Keys:</strong>
                                    <ul>
                                        <li><code>CheckoutController</code>: <code>session()->get('cart', [])</code></li>
                                        <li><code>CartService</code>: <code>session()->put('shopping_cart', $items)</code></li>
                                    </ul>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// app/Http/Controllers/CheckoutController.php
// ANTES:
$cart = session()->get('cart', []);
if (empty($cart)) {
    return redirect()->route('cart.index')
        ->with('error', 'Seu carrinho estÃ¡ vazio.');
}

// DEPOIS:
$cart = $this->cartService->getContents();
if (empty($cart)) {
    return redirect()->route('cart.index')
        ->with('error', 'Seu carrinho estÃ¡ vazio.');
}</code></pre>
                                </div>
                                <p><strong>RefatoraÃ§Ã£o:</strong> Centralizou acesso ao carrinho atravÃ©s do CartService, garantindo consistÃªncia.</p>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… Checkout agora acessa corretamente dados do carrinho</li>
                                    <li>âœ… EliminaÃ§Ã£o de inconsistÃªncias de sessÃ£o</li>
                                    <li>âœ… Fluxo de compra 100% funcional</li>
                                    <li>âœ… Arquitetura mais limpa com responsabilidades centralizadas</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-02">
                        <h3>âŒ â†’ âœ… Relacionamento [images] Indefinido</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p>Erro "Call to undefined relationship [images] on model [App\Models\Product]" em mÃºltiplas partes do sistema.</p>
                                <div class="error-trace">
                                    <code>BadMethodCallException: Call to undefined relationship [images] on model [App\Models\Product]</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>CÃ³digo tentava carregar relacionamento 'images' que nÃ£o existia. O relacionamento correto era 'productImages' conforme definido no modelo Product.</p>
                                <div class="cause-analysis">
                                    <strong>Relacionamento Correto:</strong>
                                    <code>public function productImages() { return $this->hasMany(ProductImage::class); }</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// app/Services/CartService.php
// ANTES:
Product::with('images')->whereIn('id', $productIds)->get()

// DEPOIS:
Product::with('productImages')->whereIn('id', $productIds)->get()

// app/Http/Controllers/Admin/DropshippingController.php
// ANTES:
$order->load(['user', 'items.product.images'])

// DEPOIS:
$order->load(['user', 'items.product.productImages'])

// app/Models/ProductImage.php - ADICIONADO accessor para compatibilidade:
public function getImageUrlAttribute(): string
{
    return $this->image_path;
}</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… Relacionamentos de imagens funcionam em todo sistema</li>
                                    <li>âœ… EliminaÃ§Ã£o de erros de relacionamento indefinido</li>
                                    <li>âœ… Compatibilidade mantida com accessor image_url</li>
                                    <li>âœ… Carregamento otimizado de imagens nos produtos</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-03">
                        <h3>âŒ â†’ âœ… Array Key "items" NÃ£o Encontrada</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p>View checkout tentava acessar $cartSummary['items'] que nÃ£o existia, causando erro de chave nÃ£o encontrada.</p>
                                <div class="error-trace">
                                    <code>Undefined array key "items" in resources/views/checkout/index.blade.php</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>InconsistÃªncia entre estrutura de dados retornada pelo CartService e esperada pela view. Controller passava $cartItems separadamente, mas view esperava dentro de $cartSummary.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// resources/views/checkout/index.blade.php
// ANTES:
@foreach($cartSummary['items'] as $item)
    <!-- ... -->
@endforeach
{{ $cartSummary['formatted_shipping_cost'] }}
{{ $cartSummary['formatted_pix_discount'] }}

// DEPOIS:
@foreach($cartItems as $item)
    <!-- ... -->
@endforeach
{{ $cartSummary['formatted_shipping'] }}
{{ number_format($cartSummary['pix_discount'], 2, ',', '.') }}</code></pre>
                                </div>
                                <p><strong>Ajuste:</strong> Adequou view Ã s variÃ¡veis realmente disponÃ­veis e formataÃ§Ã£o correta.</p>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… PÃ¡gina checkout exibe corretamente resumo do pedido</li>
                                    <li>âœ… EliminaÃ§Ã£o de erros de chaves indefinidas</li>
                                    <li>âœ… FormataÃ§Ã£o monetÃ¡ria consistente</li>
                                    <li>âœ… Interface de checkout completamente funcional</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-04">
                        <h3>âŒ â†’ âœ… Column 'user_id' Cannot be Null</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p>Erro ao finalizar compra sem login - sistema nÃ£o permitia checkout para usuÃ¡rios anÃ´nimos.</p>
                                <div class="error-trace">
                                    <code>SQLSTATE[23000]: Integrity constraint violation: 1048 Column 'user_id' cannot be null</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>Campo user_id na tabela orders nÃ£o permitia NULL, mas o sistema precisava suportar pedidos de usuÃ¡rios nÃ£o logados (checkout anÃ´nimo).</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// Nova migration criada:
// database/migrations/2025_07_07_032019_make_user_id_nullable_in_orders_table.php
public function up()
{
    Schema::table('orders', function (Blueprint $table) {
        $table->dropForeign(['user_id']);
        $table->foreignId('user_id')->nullable()->change();
        $table->foreign('user_id')->references('id')
              ->on('users')->onDelete('set null');
    });
}

// TambÃ©m corrigido bug no OrderCreationService:
// ANTES:
'total_price' => $item['total'], // Campo inexistente

// DEPOIS:
'total_price' => $item['quantity'] * $item['unit_price'],</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… Sistema permite checkout para usuÃ¡rios logados e anÃ´nimos</li>
                                    <li>âœ… Maior flexibilidade no processo de compra</li>
                                    <li>âœ… Constraint de foreign key atualizada adequadamente</li>
                                    <li>âœ… Estrutura preparada para diferentes tipos de clientes</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Problemas de Interface -->
                <div class="card card-full">
                    <h2>ğŸŸ¡ PROBLEMAS DE INTERFACE RESOLVIDOS</h2>

                    <div class="problem-card" id="problem-05">
                        <h3>âŒ â†’ âœ… Route [admin.orders.send_to_production] Not Defined</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p>View tentava usar rota inexistente, causando erro 404 nos botÃµes de aÃ§Ã£o do painel administrativo.</p>
                                <div class="error-trace">
                                    <code>Route [admin.orders.send_to_production] not defined</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>Nome da rota na view nÃ£o coincidia com as rotas realmente definidas em web.php. InconsistÃªncia entre nomenclatura esperada e implementada.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// resources/views/admin/orders/index.blade.php
// ANTES:
{{ route('admin.orders.send_to_production', $order) }}

// DEPOIS:
{{ route('admin.dropshipping.update_production_status', $order) }}

// VerificaÃ§Ã£o das rotas em web.php:
Route::post('/admin/dropshipping/{order}/update-production-status', 
    [DropshippingController::class, 'updateProductionStatus'])
    ->name('admin.dropshipping.update_production_status');</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… BotÃ£o "Enviar para ProduÃ§Ã£o" funciona corretamente</li>
                                    <li>âœ… EliminaÃ§Ã£o de erros 404 nos botÃµes administrativos</li>
                                    <li>âœ… ConsistÃªncia entre rotas e views</li>
                                    <li>âœ… Fluxo administrativo completamente funcional</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-06">
                        <h3>âŒ â†’ âœ… AÃ§Ãµes dos BotÃµes NÃ£o Funcionavam</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p>BotÃµes na lista de pedidos nÃ£o executavam aÃ§Ãµes - problemas de sintaxe e dados simulados impediam funcionamento.</p>
                                <div class="error-trace">
                                    <code>Trying to get property 'id' of non-object</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>Controller retornava arrays simulados, mas view usava sintaxe de objeto. Mistura entre dados mock e estrutura real causava incompatibilidade.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// app/Http/Controllers/AdminController.php
// ANTES: Dados simulados
$orders = [
    ['id' => 1, 'customer_name' => 'Mock Customer', ...],
    // ... mais dados fake
];

// DEPOIS: Dados reais do banco
$orders = Order::with('items.product')
    ->orderBy('created_at', 'desc')
    ->paginate(20);

// resources/views/admin/orders/index.blade.php
// ANTES: Sintaxe de array
{{ $order['id'] }}
{{ $order['customer_name'] }}

// DEPOIS: Sintaxe de objeto
{{ $order->order_number }}
{{ $order->customer_name }}</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… Todos botÃµes funcionam: ver detalhes, filtros, aÃ§Ãµes</li>
                                    <li>âœ… Dados reais do banco exibidos corretamente</li>
                                    <li>âœ… Interface administrativa totalmente operacional</li>
                                    <li>âœ… EliminaÃ§Ã£o de dados simulados do sistema</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-07">
                        <h3>âŒ â†’ âœ… View [admin.dropshipping.show] Not Found</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p>Controller tentava carregar view de detalhes que nÃ£o existia, causando erro 404 ao tentar visualizar pedidos.</p>
                                <div class="error-trace">
                                    <code>View [admin.dropshipping.show] not found</code>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>Arquivo show.blade.php nÃ£o existia no diretÃ³rio admin/dropshipping/. Controller estava configurado mas view correspondente nÃ£o foi criada.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code>// Criada view completa em:
// resources/views/admin/dropshipping/show.blade.php

SeÃ§Ãµes implementadas:
âœ… Header com informaÃ§Ãµes do pedido (nÃºmero, status, valor)
âœ… Dados completos do cliente (nome, email, telefone, documento)
âœ… EndereÃ§o de entrega formatado e completo
âœ… Lista detalhada de produtos com variaÃ§Ãµes e preÃ§os
âœ… BotÃµes de aÃ§Ã£o funcionais (voltar, imprimir, etc.)
âœ… Design consistente com layout administrativo</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… PÃ¡gina de detalhes carrega com todas informaÃ§Ãµes</li>
                                    <li>âœ… NavegaÃ§Ã£o completa no painel administrativo</li>
                                    <li>âœ… Interface profissional para visualizaÃ§Ã£o de pedidos</li>
                                    <li>âœ… Funcionalidade de dropshipping completamente operacional</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Problemas de ConfiguraÃ§Ã£o -->
                <div class="card card-full">
                    <h2>ğŸŸ¢ PROBLEMAS DE CONFIGURAÃ‡ÃƒO COMUNS</h2>

                    <div class="problem-card" id="problem-08">
                        <h3>âš ï¸ â†’ âœ… Erro de Assets nÃ£o Encontrados</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p>Arquivos CSS e JS retornando 404, interface sem estilos e funcionalidades JavaScript nÃ£o carregando.</p>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>Assets nÃ£o compilados ou diretÃ³rio build inexistente apÃ³s limpeza de cache.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code># RecompilaÃ§Ã£o de assets
npm run build

# Se persistir, forÃ§ar limpeza:
rm -rf public/build
npm run build

# Para desenvolvimento:
npm run dev</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… Interface carrega com estilos corretos</li>
                                    <li>âœ… JavaScript funcional</li>
                                    <li>âœ… Assets otimizados para produÃ§Ã£o</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-09">
                        <h3>âš ï¸ â†’ âœ… Session Store nÃ£o Configurado</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p>Erro de sessÃ£o nÃ£o configurada, dados de carrinho perdidos entre requests.</p>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>ConfiguraÃ§Ã£o de sessÃ£o incorreta no .env ou cache de configuraÃ§Ã£o desatualizado.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Verificar .env:
SESSION_DRIVER=file
SESSION_LIFETIME=120

# Limpar cache:
php artisan config:clear
php artisan cache:clear</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… SessÃµes funcionando corretamente</li>
                                    <li>âœ… Carrinho persiste entre pÃ¡ginas</li>
                                    <li>âœ… Login administrativo estÃ¡vel</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-10">
                        <h3>âš ï¸ â†’ âœ… Permission Denied em Storage</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p>Erro de permissÃ£o ao tentar escrever logs ou cache, sistema instÃ¡vel.</p>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>PermissÃµes incorretas nos diretÃ³rios storage/ e bootstrap/cache/.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Docker (dentro do container):
chown -R www-data:www-data /var/www/storage
chown -R www-data:www-data /var/www/bootstrap/cache
chmod -R 775 /var/www/storage
chmod -R 775 /var/www/bootstrap/cache

# Local:
chmod -R 775 storage/
chmod -R 775 bootstrap/cache/</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… Sistema de logs funcionando</li>
                                    <li>âœ… Cache operacional</li>
                                    <li>âœ… Estabilidade completa</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Problemas do Sistema de Build -->
                <div class="card card-full">
                    <h2>ğŸ”¨ PROBLEMAS DO SISTEMA DE BUILD</h2>
                    <p><em>ReferÃªncia: <a href="build.html">Sistema de Build</a> - Problemas especÃ­ficos do pipeline de assets e Docker</em></p>

                    <div class="problem-card" id="problem-11">
                        <h3>âš ï¸ â†’ âœ… Assets NÃ£o Carregando no Sistema de Build</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p><strong>Contexto:</strong> Sistema de Build - Pipeline de Assets</p>
                                <p>CSS/JS nÃ£o aparecem na pÃ¡gina apÃ³s processo de build, interface renderiza sem estilos.</p>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>Build anterior corrompido ou manifesto de assets desatualizado. Processo Vite nÃ£o completou corretamente.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Remover build anterior
rm -rf public/build

# Rebuild assets
docker exec vibegarb_node npm run build

# Verificar se manifest foi gerado
cat public/build/manifest.json</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… Assets CSS/JS carregam corretamente</li>
                                    <li>âœ… Interface renderiza com estilos Tailwind</li>
                                    <li>âœ… Pipeline de build funcional</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-12">
                        <h3>âš ï¸ â†’ âœ… Erro 504 Gateway Timeout no Build</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p><strong>Contexto:</strong> Sistema de Build - Vite Dev Server</p>
                                <p>Vite dev server nÃ£o responde, causando timeout na conexÃ£o durante desenvolvimento.</p>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>Arquivo public/hot ficou Ã³rfÃ£o apÃ³s crash do dev server, fazendo Laravel buscar servidor que nÃ£o existe.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Remover arquivo hot
rm -f public/hot

# Parar dev server e fazer build estÃ¡tico
docker exec vibegarb_node npm run build</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… EliminaÃ§Ã£o de timeouts durante desenvolvimento</li>
                                    <li>âœ… Build estÃ¡tico funciona normalmente</li>
                                    <li>âœ… Dev server pode ser reiniciado sem problemas</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-13">
                        <h3>âš ï¸ â†’ âœ… Performance Lenta no Windows (Build)</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p><strong>Contexto:</strong> Sistema de Build - Docker Performance</p>
                                <p>Build muito lento em Windows, operaÃ§Ãµes Docker demoram excessivamente.</p>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>Volumes Docker sem otimizaÃ§Ã£o :cached, vendor e node_modules sendo sincronizados desnecessariamente entre host e container.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code># docker-compose.yml otimizado:
volumes:
  - ./:/var/www:cached  # :cached Ã© crucial para Windows
  - /var/www/vendor     # Vendor no container
  - /var/www/node_modules # Node modules no container</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… Build 3-5x mais rÃ¡pido no Windows</li>
                                    <li>âœ… OperaÃ§Ãµes Docker otimizadas</li>
                                    <li>âœ… Developer experience significativamente melhor</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-14">
                        <h3>âš ï¸ â†’ âœ… Tailwind NÃ£o Aplicando Estilos no Build</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p><strong>Contexto:</strong> Sistema de Build - Tailwind CSS Pipeline</p>
                                <p>Classes Tailwind nÃ£o funcionam, CSS nÃ£o inclui estilos esperados apÃ³s build.</p>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>ConfiguraÃ§Ã£o tailwind.config.js com paths incorretos ou processo de purge removendo classes necessÃ¡rias.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Verificar tailwind.config.js content paths
# Rebuild para forÃ§ar purge
docker exec vibegarb_node npm run build

# Verificar se CSS inclui as classes
grep -A 5 "@tailwind" resources/css/app.css</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… Classes Tailwind funcionam corretamente</li>
                                    <li>âœ… CSS compilado com estilos necessÃ¡rios</li>
                                    <li>âœ… Interface responsiva como esperado</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="problem-card" id="problem-15">
                        <h3>âš ï¸ â†’ âœ… Container Node NÃ£o Responde</h3>
                        <div class="problem-details">
                            <div class="problem-section">
                                <h4>ğŸ” Problema</h4>
                                <p><strong>Contexto:</strong> Sistema de Build - Container Management</p>
                                <p>Comandos npm nÃ£o executam, container Node inacessÃ­vel ou travado.</p>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ” Causa Raiz</h4>
                                <p>Container Node crashou ou nÃ£o foi iniciado corretamente, processo principal nÃ£o estÃ¡ ativo.</p>
                            </div>

                            <div class="problem-section">
                                <h4>âš¡ SoluÃ§Ã£o Implementada</h4>
                                <div class="code-block">
                                    <pre><code># Verificar se container estÃ¡ rodando
docker ps | grep vibegarb_node

# Restart container Node
docker-compose restart node

# Verificar logs
docker logs vibegarb_node</code></pre>
                                </div>
                            </div>

                            <div class="problem-section">
                                <h4>ğŸ“Š Impacto</h4>
                                <ul>
                                    <li>âœ… Container Node operacional</li>
                                    <li>âœ… Comandos npm executam normalmente</li>
                                    <li>âœ… Pipeline de build totalmente funcional</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Comandos Ãšteis -->
                <div class="card">
                    <h2>âš¡ Comandos Ãšteis para Troubleshooting</h2>

                    <h3>DiagnÃ³stico Geral</h3>
                    <div class="code-block">
                        <pre><code># Verificar logs em tempo real
tail -f storage/logs/laravel.log

# Status das migrations
php artisan migrate:status

# Limpar todos os caches
php artisan optimize:clear

# Verificar rotas
php artisan route:list | grep admin</code></pre>
                    </div>

                    <h3>Problemas de Assets</h3>
                    <div class="code-block">
                        <pre><code># Recompilar assets
npm run build

# ForÃ§ar limpeza completa
rm -rf public/build node_modules
npm install
npm run build</code></pre>
                    </div>

                    <h3>Problemas de Banco</h3>
                    <div class="code-block">
                        <pre><code># Resetar banco (CUIDADO!)
php artisan migrate:fresh --seed

# Executar migrations pendentes
php artisan migrate

# Verificar conexÃ£o
php artisan tinker
> DB::connection()->getPdo();</code></pre>
                    </div>
                </div>

                <!-- PrevenÃ§Ã£o de Problemas -->
                <div class="card">
                    <h2>ğŸ›¡ï¸ PrevenÃ§Ã£o de Problemas</h2>

                    <h3>Checklist Antes de Deploy</h3>
                    <ul>
                        <li>âœ… <strong>Assets Compilados:</strong> <code>npm run build</code></li>
                        <li>âœ… <strong>Migrations Atualizadas:</strong> <code>php artisan migrate:status</code></li>
                        <li>âœ… <strong>Cache Limpo:</strong> <code>php artisan optimize:clear</code></li>
                        <li>âœ… <strong>ConfiguraÃ§Ã£o Verificada:</strong> <code>.env</code> atualizado</li>
                        <li>âœ… <strong>PermissÃµes Corretas:</strong> <code>storage/</code> e <code>bootstrap/cache/</code></li>
                        <li>âœ… <strong>Logs Verificados:</strong> Sem erros crÃ­ticos</li>
                    </ul>

                    <h3>Monitoramento ContÃ­nuo</h3>
                    <ul>
                        <li>ğŸ“Š <strong>Performance:</strong> Tempo de carregamento < 1s</li>
                        <li>ğŸ” <strong>Logs:</strong> VerificaÃ§Ã£o diÃ¡ria de erros</li>
                        <li>ğŸ’¾ <strong>Banco:</strong> Backup regular e integridade</li>
                        <li>ğŸ”„ <strong>SessÃµes:</strong> Funcionamento de carrinho e login</li>
                        <li>ğŸ¯ <strong>Funcionalidades:</strong> Teste de checkout completo</li>
                    </ul>
                </div>

                <!-- Contato para Suporte -->
                <div class="card conclusion">
                    <h2>ğŸ“ Suporte TÃ©cnico</h2>
                    <p>Para problemas nÃ£o cobertos neste guia:</p>
                    
                    <h3>Procedimento de Reporte</h3>
                    <ol>
                        <li><strong>Capturar Logs:</strong> <code>tail -f storage/logs/laravel.log</code></li>
                        <li><strong>Reproduzir Erro:</strong> Passos detalhados para reproduÃ§Ã£o</li>
                        <li><strong>Ambiente:</strong> Local/Docker/ProduÃ§Ã£o</li>
                        <li><strong>Contexto:</strong> O que foi feito antes do erro</li>
                    </ol>

                    <p><strong>Base de Conhecimento:</strong> Este documento Ã© atualizado continuamente com novos problemas e soluÃ§Ãµes.</p>
                </div>
            </div>
        </main>
    </div>
</body>
</html> 